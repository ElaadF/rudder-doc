
[[dsc-agent-cli]]
=== DSC Agent CLI

The Rudder agent CLI is available as a Powershell module, by running, in a Powershell terminal

----

rudder agent <action>

----

where action can be one of the following

* disable: Disable the agent, and prevent its execution

* enable: Enable the agent

* info: Show information about the agent and the node (hostname, Rudder ID, policy server, etc)

* inventory: Generate an inventory, and send it to the server

* run: Run the agent (see example output below)

* update: Update agent policy from the Rudder Server

* version: Show the version of the DSC Rudder agent


image:./images/rudder-agent-dsc-cli.png[Example of a Rudder DSC agent output on Windows]

=== Agent logs

Rudder logs are visible in the output of the agent. You can get more details about what is done with the 
`-Verbose` option:

----
rudder agent run -v
----

You can also explore all agent logs (including those from unattended runs) in the Windows Event Viewer.
Before Windows plugin version 4.2-1.6 Rudder used the windows system eventlog and was logging in 
the *Windows Logs -> Application* view, with the *Rudder* source and the *101* Event ID.

Since the Windows plugin version 4.2-1.6 Rudder will report in a dedicated windows journal named Rudder and its logs are saved on different verbosity:

* *classic Rudder reports* will have the *Event ID 101*, they are the reports sent to the server.

* *Information logs* will have the *Event ID 102* and will only be local logs.

If you had an old plugin version installed Rudder will not try to install the new journal reference because
it needs a complete reboot of the host system. 
See the last note on the Microsoft doc: https://msdn.microsoft.com/en-us/library/2awhba7a%28v=vs.110%29.aspx.

If you want to change manually the Rudder eventlog use the following process, keep in mind that it will need a machine restart to avoid any reporting issues.
First identify the current eventlog for Rudder by running in the powershell console
----
[System.Diagnostics.EventLog]::LogNameFromSourceName("Rudder", ".")
----
If it does not suit you, remove the Rudder source from it and create a new logger for Rudder
----
Remove-Eventlog -Source "Rudder"
New-Eventlog -Source "Rudder" -LogName "Rudder"
----

Then reboot the system.

